#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Log changes to change-log.md
git diff --cached --name-only | while read file; do
  if [ "$file" != "src/logs/change-log.md" ]; then
    echo "## $(date)" >> src/logs/change-log.md
    echo "- **File**: $file" >> src/logs/change-log.md
    echo "- **Lines**: $(git diff --cached $file | grep -E '^@@' | awk '{print $2}' | sed 's/,/ to /')" >> src/logs/change-log.md
    echo "- **Description**: $(git diff --cached $file | grep -E '^\+[^+]' | sed 's/^+//')" >> src/logs/change-log.md
    echo "---" >> src/logs/change-log.md
  fi
done

# Log updates to updates.md
if [ "$file" != "src/logs/updates.md" ]; then
  echo "### $(date)" >> src/logs/updates.md
  echo "- **Commit Message**: $(git log -1 --pretty=%B)" >> src/logs/updates.md
  echo "- **Files Affected**: $(git diff --cached --name-only | tr '\n' ', ')" >> src/logs/updates.md
  echo "---" >> src/logs/updates.md
fi
